# CodeSight Project Production Environment
# Copy this file to .env.production and update the values
# Generated: 2025-01-27

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

NODE_ENV=production
APP_NAME=codesight
APP_VERSION=0.1.0

# Server configuration
PORT=4000
HOST=0.0.0.0
API_PREFIX=/api

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Use PostgreSQL in production
DATABASE_URL=postgresql://postgres:${POSTGRES_PASSWORD}@postgres:5432/code_intelligence

# PostgreSQL configuration
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
POSTGRES_DB=code_intelligence

# Connection pool settings
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_CONNECTION_TIMEOUT=30000

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

REDIS_URL=redis://redis:6379
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_DB=0

# =============================================================================
# MCP SERVER CONFIGURATION
# =============================================================================

MCP_PORT=3001
MCP_HOST=0.0.0.0
MCP_ENABLE_LOGGING=true
MCP_LOG_LEVEL=info

MCP_ENABLE_SEARCH=true
MCP_ENABLE_INDEXING=true
MCP_ENABLE_ANALYSIS=true
MCP_MAX_RESULTS=100
MCP_SEARCH_TIMEOUT=5000

# =============================================================================
# RUST FFI CONFIGURATION
# =============================================================================

ENABLE_RUST_FFI=true
RUST_FFI_PATH=/app/codesight-native.node
FFI_GRACEFUL_FALLBACK=true

NAPI_MODULE_PATH=/app/codesight-native.node
NAPI_DEBUG=false

# =============================================================================
# API SERVER CONFIGURATION
# =============================================================================

API_PORT=4001
API_HOST=0.0.0.0
API_ENABLE_CORS=true
API_ENABLE_RATE_LIMIT=true
API_RATE_LIMIT_REQUESTS=100
API_RATE_LIMIT_WINDOW=60000

JWT_SECRET=${JWT_SECRET}
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# =============================================================================
# FRONTEND CONFIGURATION
# =============================================================================

# Frontend is served by web server in production
VITE_API_BASE_URL=https://your-domain.com/api
VITE_MCP_BASE_URL=https://your-domain.com/mcp
VITE_ENABLE_DEV_TOOLS=false

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE=/app/logs/app.log
LOG_MAX_SIZE=10MB
LOG_MAX_FILES=5

# =============================================================================
# MONITORING AND METRICS
# =============================================================================

ENABLE_METRICS=true
METRICS_PORT=9090
METRICS_PATH=/metrics

HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INTERVAL=30000

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

CORS_ORIGIN=https://your-frontend-domain.com
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS=Content-Type,Authorization

RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX_REQUESTS=100

HELMET_ENABLED=true
XSS_PROTECTION=true
CONTENT_SECURITY_POLICY=true

# =============================================================================
# FILE AND DIRECTORY CONFIGURATION
# =============================================================================

DATA_DIR=/app/data
CACHE_DIR=/app/cache
LOGS_DIR=/app/logs
UPLOADS_DIR=/app/uploads
TEMP_DIR=/app/temp

RUST_TARGET_DIR=/app/rust-core/target
RUST_RELEASE_DIR=/app/rust-core/target/release

# =============================================================================
# DEVELOPMENT CONFIGURATION
# =============================================================================

DEV_MODE=false
DEV_HOT_RELOAD=false
DEV_SOURCE_MAPS=false
DEV_VERBOSE_LOGGING=false

TEST_MODE=false
TEST_DATABASE_URL=postgresql://postgres:${POSTGRES_PASSWORD}@postgres:5432/code_intelligence_test
TEST_REDIS_URL=redis://redis:6379/1

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================

ENABLE_CACHE=true
CACHE_TTL=3600
CACHE_MAX_SIZE=1000
ENABLE_COMPRESSION=true
COMPRESSION_LEVEL=6

INDEXING_BATCH_SIZE=100
INDEXING_MAX_CONCURRENT=4
INDEXING_TIMEOUT=30000

SEARCH_MAX_RESULTS=100
SEARCH_TIMEOUT=5000
SEARCH_ENABLE_FUZZY=true
SEARCH_FUZZY_THRESHOLD=0.6

# =============================================================================
# EXTERNAL SERVICES CONFIGURATION
# =============================================================================

# Add your production API keys here
OPENAI_API_KEY=${OPENAI_API_KEY}
GITHUB_TOKEN=${GITHUB_TOKEN}
DOCKER_REGISTRY_TOKEN=${DOCKER_REGISTRY_TOKEN}

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================

DOCKER_ENVIRONMENT=production
DOCKER_COMPOSE_PROJECT=codesight
DOCKER_NETWORK=codesight-network
DOCKER_EXTERNAL_NETWORK=codesight-network

# =============================================================================
# CI/CD CONFIGURATION
# =============================================================================

CI=true
CD=true
GITHUB_ACTIONS=true
BUILD_NUMBER=${BUILD_NUMBER}
BUILD_COMMIT=${BUILD_COMMIT}

# =============================================================================
# FEATURE FLAGS
# =============================================================================

ENABLE_TELEMETRY=true
ENABLE_ANALYTICS=true
ENABLE_ERROR_REPORTING=true
ENABLE_AUTO_UPDATES=false
ENABLE_BETA_FEATURES=false